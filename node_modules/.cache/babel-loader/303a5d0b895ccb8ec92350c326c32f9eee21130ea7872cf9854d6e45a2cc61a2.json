{"ast":null,"code":"import React,{useEffect,useState}from'react';import{generateQuestionsWithGemini,getGeminiKey,setGeminiKey}from'../services/ai';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AiQuestionModal=_ref=>{let{onClose,onGenerate}=_ref;const[apiKey,setApiKey]=useState('');const[prompt,setPrompt]=useState('');const[count,setCount]=useState(10);const[saving,setSaving]=useState(false);const[loading,setLoading]=useState(false);const[error,setError]=useState('');const[savedOnce,setSavedOnce]=useState(false);useEffect(()=>{setApiKey(getGeminiKey());},[]);const handleSaveKey=async()=>{try{setSaving(true);setGeminiKey(apiKey);setSavedOnce(true);}catch(e){setError((e===null||e===void 0?void 0:e.message)||'API 키 저장 실패');}finally{setSaving(false);}};const handleGenerate=async()=>{setError('');if(!prompt.trim()){setError('프롬프트를 입력해주세요.');return;}try{setLoading(true);console.info('[AI_GEN_UI] ▶ 요청',{count,prompt});const list=await generateQuestionsWithGemini(prompt.trim(),count);console.info('[AI_GEN_UI] ◀ 결과',{received:list.length});onGenerate(list);}catch(e){console.warn('[AI_GEN_UI] ✖ 실패',{message:e===null||e===void 0?void 0:e.message});setError((e===null||e===void 0?void 0:e.message)||'AI 문제 생성 실패');}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"modal-backdrop\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"AI \\uBB38\\uC81C \\uCD94\\uAC00\"}),/*#__PURE__*/_jsx(\"button\",{className:\"close-btn\",onClick:onClose,children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Gemini API \\uD0A4\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:apiKey,onChange:e=>setApiKey(e.target.value),placeholder:\"AIza...\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSaveKey,disabled:saving,children:saving?'저장 중...':'키 저장'}),savedOnce&&/*#__PURE__*/_jsx(\"small\",{children:\"\\uD0A4\\uAC00 \\uC800\\uC7A5\\uB418\\uC5C8\\uC2B5\\uB2C8\\uB2E4. \\uBE0C\\uB77C\\uC6B0\\uC800\\uC5D0\\uC11C \\uAE30\\uC5B5\\uD569\\uB2C8\\uB2E4.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\uD504\\uB86C\\uD504\\uD2B8\"}),/*#__PURE__*/_jsx(\"textarea\",{value:prompt,onChange:e=>setPrompt(e.target.value),rows:4,placeholder:\"\\uC608: 4\\uD559\\uB144 \\uC18C\\uC218 \\uBB38\\uC81C 10\\uAC1C \\uB0B4\\uC918\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\uC0DD\\uC131 \\uAC1C\\uC218\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:1,max:50,value:count,onChange:e=>setCount(parseInt(e.target.value)||1)})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-text\",children:error})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-secondary\",onClick:onClose,children:\"\\uCDE8\\uC18C\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:handleGenerate,disabled:loading,children:loading?'생성 중...':'AI로 생성'})]})]})});};export default AiQuestionModal;","map":{"version":3,"names":["React","useEffect","useState","generateQuestionsWithGemini","getGeminiKey","setGeminiKey","jsx","_jsx","jsxs","_jsxs","AiQuestionModal","_ref","onClose","onGenerate","apiKey","setApiKey","prompt","setPrompt","count","setCount","saving","setSaving","loading","setLoading","error","setError","savedOnce","setSavedOnce","handleSaveKey","e","message","handleGenerate","trim","console","info","list","received","length","warn","className","children","onClick","type","value","onChange","target","placeholder","disabled","rows","min","max","parseInt"],"sources":["C:/Users/9204r/.cursor/avatar/src/components/AiQuestionModal.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { generateQuestionsWithGemini, getGeminiKey, setGeminiKey, AiQuestion } from '../services/ai';\n\ninterface Props {\n  onClose: () => void;\n  onGenerate: (questions: AiQuestion[]) => void;\n}\n\nconst AiQuestionModal: React.FC<Props> = ({ onClose, onGenerate }) => {\n  const [apiKey, setApiKey] = useState<string>('');\n  const [prompt, setPrompt] = useState<string>('');\n  const [count, setCount] = useState<number>(10);\n  const [saving, setSaving] = useState<boolean>(false);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [error, setError] = useState<string>('');\n  const [savedOnce, setSavedOnce] = useState<boolean>(false);\n\n  useEffect(() => {\n    setApiKey(getGeminiKey());\n  }, []);\n\n  const handleSaveKey = async () => {\n    try {\n      setSaving(true);\n      setGeminiKey(apiKey);\n      setSavedOnce(true);\n    } catch (e: any) {\n      setError(e?.message || 'API 키 저장 실패');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleGenerate = async () => {\n    setError('');\n    if (!prompt.trim()) {\n      setError('프롬프트를 입력해주세요.');\n      return;\n    }\n    try {\n      setLoading(true);\n      console.info('[AI_GEN_UI] ▶ 요청', { count, prompt });\n      const list = await generateQuestionsWithGemini(prompt.trim(), count);\n      console.info('[AI_GEN_UI] ◀ 결과', { received: list.length });\n      onGenerate(list);\n    } catch (e: any) {\n      console.warn('[AI_GEN_UI] ✖ 실패', { message: e?.message });\n      setError(e?.message || 'AI 문제 생성 실패');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"modal-backdrop\">\n      <div className=\"modal\">\n        <div className=\"modal-header\">\n          <h3>AI 문제 추가</h3>\n          <button className=\"close-btn\" onClick={onClose}>×</button>\n        </div>\n        <div className=\"modal-body\">\n          <div className=\"form-group\">\n            <label>Gemini API 키</label>\n            <input\n              type=\"text\"\n              value={apiKey}\n              onChange={(e) => setApiKey(e.target.value)}\n              placeholder=\"AIza...\"\n            />\n            <button onClick={handleSaveKey} disabled={saving}>\n              {saving ? '저장 중...' : '키 저장'}\n            </button>\n            {savedOnce && <small>키가 저장되었습니다. 브라우저에서 기억합니다.</small>}\n          </div>\n\n          <div className=\"form-group\">\n            <label>프롬프트</label>\n            <textarea\n              value={prompt}\n              onChange={(e) => setPrompt(e.target.value)}\n              rows={4}\n              placeholder=\"예: 4학년 소수 문제 10개 내줘\"\n            />\n          </div>\n\n          <div className=\"form-group\">\n            <label>생성 개수</label>\n            <input\n              type=\"number\"\n              min={1}\n              max={50}\n              value={count}\n              onChange={(e) => setCount(parseInt(e.target.value) || 1)}\n            />\n          </div>\n\n          {error && <div className=\"error-text\">{error}</div>}\n        </div>\n        <div className=\"modal-footer\">\n          <button className=\"btn-secondary\" onClick={onClose}>취소</button>\n          <button className=\"btn-primary\" onClick={handleGenerate} disabled={loading}>\n            {loading ? '생성 중...' : 'AI로 생성'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AiQuestionModal;\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}